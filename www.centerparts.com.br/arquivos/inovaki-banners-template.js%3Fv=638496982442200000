/*************** SCRIPT AQUI ***************/

const infoCatalogo = [
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 1,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://http2.mlstatic.com/D_NQ_NP_965161-MLB42008351597_052020-O.webp",
    key: "1713295510915-photomode_11012024_184113.png",
  },
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 2,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://http2.mlstatic.com/D_NQ_NP_640313-MLB42008381113_052020-O.webp",
    key: "1713295510915-photomode_11012024_184113.png",
  },
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 3,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://http2.mlstatic.com/D_NQ_NP_818656-MLB42008371420_052020-O.webp",
    key: "1713295510915-photomode_11012024_184113.png",
  },
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 1,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://http2.mlstatic.com/D_NQ_NP_965161-MLB42008351597_052020-O.webp",
    key: "1713295510915-photomode_11012024_184113.png",
  },
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 2,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://http2.mlstatic.com/D_NQ_NP_640313-MLB42008381113_052020-O.webp",
    key: "1713295510915-photomode_11012024_184113.png",
  },
];

const infoBanner = [
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 1,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://www.topgear.com/sites/default/files/cars-car/image/2019/12/images_original_15164-volkswagengolfgtiperformance.jpg",
    key: "1713295510915-photomode_11012024_184113.png",
  },
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 2,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://www.topgear.com/sites/default/files/cars-car/image/2019/12/images_original_15164-volkswagengolfgtiperformance.jpg",
    key: "1713295510915-photomode_11012024_184113.png",
  },
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 3,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://www.topgear.com/sites/default/files/cars-car/image/2019/12/images_original_15164-volkswagengolfgtiperformance.jpg",
    key: "1713295510915-photomode_11012024_184113.png",
  },
];

const logoHome = [
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 1,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://centerparts.vteximg.com.br/arquivos/2m-plastic.png",
    key: "1713295510915-photomode_11012024_184113.png",
  },
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 2,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://centerparts.vteximg.com.br/arquivos/2m-plastic.png",
    key: "1713295510915-photomode_11012024_184113.png",
  },
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 3,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://centerparts.vteximg.com.br/arquivos/2m-plastic.png",
    key: "1713295510915-photomode_11012024_184113.png",
  },
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 3,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://centerparts.vteximg.com.br/arquivos/2m-plastic.png",
    key: "1713295510915-photomode_11012024_184113.png",
  },
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 3,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://centerparts.vteximg.com.br/arquivos/2m-plastic.png",
    key: "1713295510915-photomode_11012024_184113.png",
  },
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 3,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://centerparts.vteximg.com.br/arquivos/2m-plastic.png",
    key: "1713295510915-photomode_11012024_184113.png",
  },
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 3,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://centerparts.vteximg.com.br/arquivos/2m-plastic.png",
    key: "1713295510915-photomode_11012024_184113.png",
  },
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 3,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://centerparts.vteximg.com.br/arquivos/2m-plastic.png",
    key: "1713295510915-photomode_11012024_184113.png",
  },
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 3,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://centerparts.vteximg.com.br/arquivos/2m-plastic.png",
    key: "1713295510915-photomode_11012024_184113.png",
  }
];

const carouselLateral = [
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 1,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://barataopecasautomotivas.com.br/wp-content/uploads/2023/07/Frame-190536.jpg.webp",
    key: "1713295510915-photomode_11012024_184113.png",
  },
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 2,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://barataopecasautomotivas.com.br/wp-content/uploads/2023/07/Frame-190536.jpg.webp",
    key: "1713295510915-photomode_11012024_184113.png",
  },
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 3,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://barataopecasautomotivas.com.br/wp-content/uploads/2023/07/Frame-190536.jpg.webp",
    key: "1713295510915-photomode_11012024_184113.png",
  },
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 3,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://barataopecasautomotivas.com.br/wp-content/uploads/2023/07/Frame-190536.jpg.webp",
    key: "1713295510915-photomode_11012024_184113.png",
  },
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 3,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://barataopecasautomotivas.com.br/wp-content/uploads/2023/07/Frame-190536.jpg.webp",
    key: "1713295510915-photomode_11012024_184113.png",
  },
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 3,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://barataopecasautomotivas.com.br/wp-content/uploads/2023/07/Frame-190536.jpg.webp",
    key: "1713295510915-photomode_11012024_184113.png",
  },
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 3,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://barataopecasautomotivas.com.br/wp-content/uploads/2023/07/Frame-190536.jpg.webp",
    key: "1713295510915-photomode_11012024_184113.png",
  },
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 3,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://barataopecasautomotivas.com.br/wp-content/uploads/2023/07/Frame-190536.jpg.webp",
    key: "1713295510915-photomode_11012024_184113.png",
  },
  {
    id: "538b5e4f-0723-43fe-a454-20bc88770089",
    title: "Banner Title",
    position: 3,
    redirect_url: "www.google.com",
    visible: true,
    banner_id: "538b5e4f-0723-43fe-a454-20bc88770089",
    path: "https://barataopecasautomotivas.com.br/wp-content/uploads/2023/07/Frame-190536.jpg.webp",
    key: "1713295510915-photomode_11012024_184113.png",
  }
];

$(document).ready(() => {
  renderCatalogo();
  renderPagFornecedor();

  renderBanner();
  renderLogosHome();
  rBannerLateral();
  setupCloseLateralBanner();
});

async function renderBanner() {
  const menuBanners = document.querySelector(".inovaki-new-home .mz-system");

  if (menuBanners) {
  
    try {
      let response = await fetch(`https://centerparts-api.inovaki.com.br/banners/banner-principal`);
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      const data = await response.json();

      if (data && data.length > 0) {
        menuBanners.insertAdjacentHTML(
          "afterbegin",
          `<div class="carrouselHome">
          ${data.map((banner) => {
            return `
            <div>
              <a id="banimg" href="${banner.redirect_url}"><img src="https://${banner.path}" alt="${banner.key}" /></a>
            </div>
            `;
          }).join(" ")}
          </div>`
        );

        $(".inovaki-new-home .carrouselHome").slick({
          prevArrow:
            '<button type="button" class="slick-prev" style="position: absolute;left: 20px;top: 50%;z-index: 1000;background-color: #fff;border: none;color: black;width: 40px;height: 40px;border-radius: 20px;opacity: 0.75;transform: translateY(-50%);"><i class="icon-chevron-left" aria-hidden="true"></i></button>',
          nextArrow:
            '<button type="button" class="slick-next" style="position: absolute;right: 20px;top: 50%;z-index: 1000;background-color: #fff;border: none;color: black;width: 40px;height: 40px;border-radius: 20px;opacity: 0.75;transform: translateY(-50%);"><i class="icon-chevron-right" aria-hidden="true"></i></button>',
          dots: false,
          fade: true,
          infinite: true,
          cssEase: "linear",
          autoplay: true,
          autoplaySpeed: 6000,
        });
      }
    } catch (error) {
      console.error("Fetch error:", error);
      return '';
    }
  }
}

async function renderLogosHome() {
  const logosSlides = document.querySelector(".inovaki-new-home .mz-slider-marcas");
  if (logosSlides) {

    try {
      let response = await fetch(`https://centerparts-api.inovaki.com.br/banners/logomarca-home`);
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      const data = await response.json();

      if (data && data.length > 0) {
        logosSlides.insertAdjacentHTML(
          "afterbegin",
          `${data.map((logo) => {
            return `
            <ul>
              <li><a class="mx-auto" href=""><img src="https://${logo.path}" alt="${logo.key}" /></a></li>
            </ul>
            `;
          }).join(" ")}`
        );

        $(".inovaki-new-home .mz-slider-marcas").slick({
          dots: false,
          slidesToShow: 7,
          slidesToScroll: 1,
          responsive: [
            {
              breakpoint: 900,
              settings: {
                slidesToShow: 5
              }
            },
            {
              breakpoint: 480,
              settings: {
                slidesToShow: 2
              }
            }
          ],
          infinite: true,
        });
      }
    } catch (error) {
      console.error("Fetch error:", error);
      return '';
    }
  }
}

async function rBannerLateral() {
  const bannerLateral = document.querySelector(".mz-sidebar");
  if (bannerLateral) {

    try {
      let response = await fetch(`https://centerparts-api.inovaki.com.br/banners/banner-menu-lateral`);
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      const data = await response.json();

      if (data && data.length > 0) {
        bannerLateral.insertAdjacentHTML(
          "beforeend",
          `<div class="carrocelLateral">
          ${data.map((banner) => {
            return `
              <div> 
                 <a href="${banner.redirect_url}"><img id="main-banner-lateral" src="https://${banner.path}" alt="${banner.key}"></a>
              </div>
            `;
          }).join(" ")}
          </div>`
        );

        $(".carrocelLateral").slick({
          prevArrow:
            '<button type="button" class="slick-prev" style="position: absolute;left: 10px;top: 50%;z-index: 1000;background-color: #fff;border: none;color: black;width: 20px;height: 20px;border-radius: 20px;opacity: 0.75;transform: translateY(-50%);"><i class="icon-chevron-left" aria-hidden="true""></i></button>',
          nextArrow:
            '<button type="button" class="slick-next" style="position: absolute;right: 10px;top: 50%;z-index: 1000;background-color: #fff;border: none;color: black;width: 20px;height: 20px;border-radius: 20px;opacity: 0.75;transform: translateY(-50%);"><i class="icon-chevron-right" aria-hidden="true"></i></button>',
          fade: true,
          infinite: true,
          cssEase: "linear",
          dots: false,
          autoplay: true,
          autoplaySpeed: 6000,
        });
      }
    } catch (error) {
      console.error("Fetch error:", error);
      return '';
    }
  }
}

function setupCloseLateralBanner () {
  const sidebar = document.querySelector('.mz-sidebar');
  
  sidebar.addEventListener('click', (event) => {
    if (event.target.closest('#openClose')) {
      const arrowDisplay = window.getComputedStyle(document.querySelector('.icon-chevron-left')).display;
      document.getElementById('main-banner-lateral').style.display = arrowDisplay === 'none' ? 'none' : 'inline-block';
    }
  });
}

// async function renderPagFornecedor() {
//   const importPagFornecedor = document.querySelector(".inovaki-new-catalog main .container");
//   if (importPagFornecedor) {

//     try {
//       let response = await fetch(`https://centerparts-api.inovaki.com.br/banners/banner-menu-lateral`);
//       if (!response.ok) {
//         throw new Error(`HTTP error! status: ${response.status}`);
//       }
//       const data = await response.json();

//       if (data && data.length > 0) {

//         const promises = data.map(async (logos) => {
//           try {
//             let response = await fetch(`/api/catalog_system/pub/products/search?fq=productId:${INFO_PRODUCT_ID}`);
//             if (!response.ok) {
//               throw new Error(`HTTP error! status: ${response.status}`);
//             }
//             const dataVtex = await response.json();

//             if (dataVtex && dataVtex.length > 0) {
//               return `
//                 <div id="cardProduto">
//                   <div id="imgProduto">
//                     <img src="${dataVtex[0].items[0].images[0].imageUrl}" alt="" />
//                   </div>
//                   <div class="titleProdut">
//                     <p id="txttitulo">
//                       ${dataVtex[0].productName}
//                     </p>
//                     <div id="CodValor">
//                       <p id="txtCodigo">${dataVtex[0].productReferenceCode}</p>
//                       <p id="txtValor"><span id="spanReais">R$</span>${dataVtex[0].items[0].sellers[0].commertialOffer.Price}</p>
//                     </div>
//                   </div>
//                 </div>`;
//             }
//           } catch (error) {
//             console.error("Fetch error:", error);
//             return '';
//           }
//         });

//         const cards = await Promise.all(promises);
//         const htmlString = cards.join('');

//         importPagFornecedor.insertAdjacentHTML("afterbegin", `
//           <div id="containerG">
//             <div id="contBanner">
//               <img id="imgBannerInterna"
//                 src="${IMAGE_BANNER_FORNECEDOR}"
//                 alt=""/>
//             </div>
//           </div>
//           <div class="destaqueDoDia">
//             <div id="containerDestaque">
//               <div id="txtDestaque">
//                 <h1 id="txtDestaqueDia">Destaques do dia</h1>
//               </div>
//             </div>
//             <div class="containerCard">
//               ${htmlString}
//             </div>
//           </div>
//         `);
//       }
//     } catch (error) {
//       console.error("Fetch error:", error);
//       return '';
//     }
//   }
// }

async function renderPagFornecedor() {
  const importPagFornecedor = document.querySelector(".inovaki-new-catalog main .container");
  if (infoCatalogo) {

    const promises = infoCatalogo.map(async (logos) => {
      try {
        let response = await fetch(`/api/catalog_system/pub/products/search?fq=productId:2062504`);
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        const data = await response.json();

        if (data && data.length > 0) {
          return `
            <div id="cardProduto">
              <div id="imgProduto">
                <img src="${data[0].items[0].images[0].imageUrl}" alt="" />
              </div>
              <div class="titleProdut">
                <p id="txttitulo">
                  ${data[0].productName}
                </p>
                <div id="CodValor">
                  <p id="txtCodigo">${data[0].productReferenceCode}</p>
                  <p id="txtValor"><span id="spanReais">R$</span>${data[0].items[0].sellers[0].commertialOffer.Price}</p>
                </div>
              </div>
            </div>`;
        }
      } catch (error) {
        console.error("Fetch error:", error);
        return '';
      }
    });

    const cards = await Promise.all(promises);
    const htmlString = cards.join('');

    importPagFornecedor.insertAdjacentHTML("afterbegin", `
      <div id="containerG">
        <div id="contBanner">
          <img id="imgBannerInterna"
            src="https://mwcompany-adv.transforms.svdcdn.com/production/wpImported/2019-2021/red-mk7-gti-lowered-apr-tuned-remus-exhaust-adv1-flowspec-wheels-banner.jpg?w=1200&h=630&q=82&auto=format&fit=crop&dm=1696443183&s=24b29dafcf6a8a0c3609359f20bbf1b0"
            alt=""/>
        </div>
      </div>
      <div class="destaqueDoDia">
        <div id="containerDestaque">
          <div id="txtDestaque">
            <h1 id="txtDestaqueDia">Destaques do dia</h1>
          </div>
        </div>
        <div class="containerCard">
          ${htmlString}
        </div>
      </div>`
    );
  }
}

async function renderCatalogo() {
  const importCatalogo = document.querySelector(".inovaki-new-catalog main .container");
  if (importCatalogo) {

    try {
      let response = await fetch(`https://centerparts-api.inovaki.com.br/banners/ordenacao-de-fornecedores`);
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      const data = await response.json();

      if (data && data.length > 0) {
        importCatalogo.insertAdjacentHTML(
          "afterbegin",
          `<div class="catalogo" >
            ${data.map((logos) => {
              return `
              <div class="cardslogo" >
                <a href="${logos.redirect_url}"><img id="imgLogoM" src="https://${logos.path}" alt="${logos.key}" ></img></a>
              </div>
              `;
            }).join(" ")}
          </div>`
        );
      }
    } catch (error) {
      console.error("Fetch error:", error);
      return '';
    }
  }
}